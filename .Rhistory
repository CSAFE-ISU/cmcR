draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
d2
d1 <- dat5$highCCFPairs$`cellID = x = 1 - 72,y = 215 - 285, theta = 30`[[1]]
d2 <- dat5$highCCFPairs$`cellID = x = 1 - 72,y = 215 - 285, theta = 30`[[2]]
d2
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2)),
y0 = (floor(nrow(.)/2)),
x1 = (floor(ncol(.)/2)) + 1,
y1 = (floor(ncol(.)/2)) + 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2)),
y0 = (floor(nrow(.)/2)),
x1 = (floor(ncol(.)/2)) + 1,
y1 = (floor(ncol(.)/2)) + 1,
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2)),
y0 = (floor(nrow(.)/2)),
x1 = (floor(ncol(.)/2)) + .5,
y1 = (floor(ncol(.)/2)) + .5,
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2)),
y0 = (floor(nrow(.)/2)),
x1 = (floor(ncol(.)/2)) + .1,
y1 = (floor(ncol(.)/2)) + .1,
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2)),
y0 = (floor(nrow(.)/2)),
x1 = (floor(ncol(.)/2)),
y1 = (floor(ncol(.)/2)),
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2)),
y0 = (floor(nrow(.)/2)),
x1 = (floor(ncol(.)/2)),
y1 = (floor(ncol(.)/2)),
color = 1) %>%
plot()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(ncol(.)/2)),
y0 = (floor(nrow(.)/2)),
x1 = (floor(ncol(.)/2)) + 1,
y1 = (floor(nrow(.)/2)) + 1,
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2)),
y0 = (floor(ncol(.)/2)),
x1 = (floor(nrow(.)/2)) + 1,
y1 = (floor(ncol(.)/2)) + 1,
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31),
y0 = (floor(ncol(.)/2)) + 34.5,
x1 = (floor(nrow(.)/2)) -31,
y1 = (floor(ncol(.)/2)) + 34.5,
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
dat4$highCCFPairs[1] %>%
purrr::map(~ cmcR:::ccfMapPlot(.[[1]],
t(.[[2]])))
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5,
x1 = (floor(nrow(.)/2)) -31,
y1 = (floor(ncol(.)/2)) + 34.5,
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31,
y1 = (floor(ncol(.)/2)) + 34.5,
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(ncol(d1)/2),
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(ncol(d1)/2),
color = 1) %>%
as.matrix()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(ncol(d1)/2),
color = 1) %>%
as.matrix() %>%
dim()
dim(d2)
imager::imfill(x = nrow(d2),y = ncol(d2),val = 0) %>%
draw_rect(x0 = (floor(ncol(.)/2) - 31 - floor(ncol(d1)/2)),
y0 = (floor(nrow(.)/2)) + 34.5 - floor(nrow(d1)/2),
x1 = (floor(ncol(.)/2)) -31 + floor(ncol(d1)/2),
y1 = (floor(nrow(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1) %>%
as.matrix() %>%
dim()
imager::imfill(x = nrow(d2),y = ncol(d2),val = 0) %>%
draw_rect(x0 = (floor(ncol(.)/2) - 31 - floor(ncol(d1)/2)),
y0 = (floor(nrow(.)/2)) + 34.5 - floor(nrow(d1)/2),
x1 = (floor(ncol(.)/2)) -31 + floor(ncol(d1)/2),
y1 = (floor(nrow(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1) %>%
plot()
d2 %>%
as.cimg() %>%
plot()
imager::imfill(x = nrow(d2),y = ncol(d2),val = 0) %>%
draw_rect(x0 = (floor(ncol(.)/2) + 31 + floor(ncol(d1)/2)),
y0 = (floor(nrow(.)/2)) - 34.5 + floor(nrow(d1)/2),
x1 = (floor(ncol(.)/2)) + 31 - floor(ncol(d1)/2),
y1 = (floor(nrow(.)/2)) - 34.5 - floor(nrow(d1)/2),
color = 1)
d2 %>%
as.cimg() %>%
plot()
imager::imfill(x = nrow(d2),y = ncol(d2),val = 0) %>%
draw_rect(x0 = (floor(ncol(.)/2) + 31 + floor(ncol(d1)/2)),
y0 = (floor(nrow(.)/2)) - 34.5 + floor(nrow(d1)/2),
x1 = (floor(ncol(.)/2)) + 31 - floor(ncol(d1)/2),
y1 = (floor(nrow(.)/2)) - 34.5 - floor(nrow(d1)/2),
color = 1) %>%
plot()
imager::imfill(x = nrow(d2),y = ncol(d2),val = 0) %>%
draw_rect(x0 = (floor(ncol(.)/2) - 31 - floor(ncol(d1)/2)),
y0 = (floor(nrow(.)/2)) + 34.5 - floor(nrow(d1)/2),
x1 = (floor(ncol(.)/2)) -31 + floor(ncol(d1)/2),
y1 = (floor(nrow(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1) %>%
plot()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile() +
coord_fixed()
imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.matrix() %>%
dim()
d2 %>%
as.cimg() %>%
as.data.frame() %>%
ggplot(aes(x=x,y=y,fill=value)) +
geom_tile()
d2 %>%
t() %>%
as.cimg() %>%
as.data.frame() %>%
ggplot(aes(x=x,y=y,fill=value)) +
geom_tile()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
plot()
imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1) %>%
# draw_rect(y0 = (floor(nrow(.)/2)) + 31 - floor(nrow(d1)/2),
#           x0 = (floor(ncol(.)/2) - 36 - floor(ncol(d1)/2)),
#           y1 = (floor(nrow(.)/2)) + 31 + floor(nrow(d1)/2),
#           x1 = (floor(ncol(.)/2) - 36 + floor(ncol(d1)/2)),
#           color = 1) %>%
as.matrix() %>%
dim()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = 0) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
plot()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
plot()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
as.data.frame() %>%
ggplot(aes(x = x,y = y,fill = value)) +
geom_tile()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
plot()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
plot()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
as.data.frame() %>%
ggplot(aes(x =x ,y = y,value = value)) +
geom_tile()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
as.data.frame() %>%
mutate(value = ifelse(is.na(value),0,value)) %>%
ggplot(aes(x =x ,y = y,value = value)) +
geom_tile()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
as.data.frame()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
as.data.frame() %>%
filter(!is.na(value))
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
as.data.frame() %>%
mutate(value = value*10^6)
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
as.data.frame() %>%
mutate(value = value*10^6) %>%
filter(!is.na(value))
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
as.data.frame() %>%
mutate(value = value*10^6) %>%
mutate(value = ifelse(is.na(value),0,value))
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
as.data.frame() %>%
mutate(value = value*10^6) %>%
mutate(value = ifelse(is.na(value),0,value)) %>%
ggplot(aes(x=x,y=y,colour=value)) +
geom_tile()
d2 %>%
t() %>%
as.cimg() %>%
imlist(.,imager::imfill(x = ncol(d2),y = nrow(d2),val = NA) %>%
draw_rect(x0 = (floor(nrow(.)/2) - 31 - floor(nrow(d1)/2)),
y0 = (floor(ncol(.)/2)) + 34.5 - floor(ncol(d1)/2),
x1 = (floor(nrow(.)/2)) -31 + floor(nrow(d1)/2),
y1 = (floor(ncol(.)/2)) + 34.5 + floor(nrow(d1)/2),
color = 1)) %>%
mult() %>%
as.data.frame() %>%
mutate(value = value*10^6) %>%
mutate(value = ifelse(is.na(value),0,value)) %>%
ggplot(aes(x=x,y=y,fill=value)) +
geom_tile()
cmcR:::ccfMap(dat4$highCCFPairs$[[1]],
dat4$highCCFPairs$`cellID = x = 1 - 72,y = 215 - 285, theta = 30`
cmcR:::ccfMap(dat4$highCCFPairs$[[1]],
cmcR:::ccfMap(dat4$highCCFPairs$`cellID = x = 1 - 72,y = 215 - 285, theta = 30`[[1]],
dat4$highCCFPairs$`cellID = x = 1 - 72,y = 215 - 285, theta = 30`[[2]]) %>%
Re() %>%
as.cimg() %>%
plot()
dat4$highCCFPairs[2] %>%
purrr::map(~ cmcR:::ccfMapPlot(.[[1]],
t(.[[2]])))
dat4$topResults
